# 벨만 포드 알고리즘 : 비용이 음수인 간선이 있을 때 최단 경로를 구하는 법

## 음수 간선이 포함된 상황에서의 최단 거리 문제

### BOJ '타임머신' 문제

N개의 도시가 있다. 한 도시에서 출발하여 다른 도시에 도착하는 버스가 M개 있다. 각 버스는 A, B, C로 나타낼 수 있는데, A는 시작도시, B는 도착도시, C는 버스를 타고 이동하는데 걸리는 시간이다. 시간 C가 양수가 아닌 경우가 있다. C = 0인 경우는 순간이동을 하는 경우, C < 0인 경우는 타임머신으로 시간을 되돌아가는 경우이다. 1번 도시에서 출발해서 나머지 도시로 가는 가장 빠른 시간을 구하는 프로그램을 작성

- **도시의 개수** : N (1 <= N <= 500)
- **버스 노선의 개수** : M ( 1 <= M <= 6000)



### 문제 해결 방법

모든 간선의 비용이 **양수**일때는 다익스트라 최단 경로 알고리즘을 사용하면 된다.

하지만 **음수 간선**이 포함된다면 <u>벨만 포드 알고리즘</u> 사용

하지만 **음수 간선의 순환**이 포함된다면, 이 경우 최단 거리가 음의 무한인 노드가 발생



## 벨만 포드(Bellman-Ford) 알고리즘

음수 간선에 관하여 최단 경로 문제는 다음과 같이 분류 가능

1. 모든 간선이 양수인 경우
2. 음수 간선이 있는 경우
   1. 음수 간선 순환 없는 경우
   2. 음수 간선 순환 있는 경우

**벨만 포드 최단 경로 알고리즘**은 <u>음의 간선이 포함된 상황에서도 사용</u> 가능

- 또한 <u>음수 간선의 순환을 감지</u>할 수 있다.
- 벨만 포드의 기본 시간 복잡도는 **O(VE)**로 다익스트라 알고리즘에 비해 느리다.

 

### 문제 해결 방법

**벨만 포드 알고리즘**은 다음과 같다.

1. 출발 노드를 설정
2. 최단 거리 테이블을 초기화
3. 다음의 과정을 N - 1번 반복
   1. 전체 간선 E개를 하나씩 확인
   2. 각 간선을 거쳐 다른 노드로 가는 비용을 계산하여 최단 거리 테이블 갱신

- 만약 <u>음수 간선 순환이 발생하는지 체크하고 싶다면</u> 3번의 과정을 한 번 더 수행
  - 이때 최단 거리 테이블이 갱신된다면 음수 간선 순환이 존재하는 것



### 벨만 포드 알고리즘 VS 다익스트라 알고리즘

**다익스트라 알고리즘**

- <u>매번 방문하지 않은 노드 중에서 최단 거리가 가장 짧은 노드를 선택</u>
- 음수 간선이 없다면 최적의 해를 찾을 수 있다.

**벨만 포드 알고리즘**

- <u>매번 모든 간선을 전부 확인</u>
  - 따라서 **다익스트라 알고리즘에서의 최적의 해를 항상 포함**
- 다익스트라 알고리즘에 비해 시간이 오래 걸리지만 음수 간선 순환 탐지 가능



### 벨만 포드(Bellman-Ford) 알고리즘  소스코드(Python)

12.py line 1















 